var p=Object.defineProperty;var g=(n,e,t)=>e in n?p(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var d=(n,e,t)=>g(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();class f{constructor(){d(this,"googlePhotosAPIEndpoint","https://photoslibrary.googleapis.com/v1/uploads")}async upload(e,t){const s=new Headers({Authorization:`Bearer ${t}`,"Content-Type":"application/octet-stream","X-Goog-Upload-Content-Type":e.type,"X-Goog-Upload-Protocol":"raw"}),o=await fetch(this.googlePhotosAPIEndpoint,{method:"POST",headers:s,body:e});if(!o.ok)throw new Error(`Upload failed with status: ${o.status}`);return await o.text()}}class h{setAccessToken(e){localStorage.setItem("accessToken",e)}getAccessToken(){return localStorage.getItem("accessToken")??""}async exchangeForAccessToken(e){const t=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:"YOUR_CLIENT_ID",client_secret:"YOUR_CLIENT_SECRET",grant_type:"authorization_code",code:e,redirect_uri:"postmessage"})});if(!t.ok)throw new Error("Failed to exchange JWT for access token");return(await t.json()).access_token}}const r=document.querySelector("#camera-input"),i=document.querySelector("#camera-image"),l=document.querySelector("#login-button"),u=new h,m=new f;r&&(i==null||i.addEventListener("click",()=>{r==null||r.click()}),r.addEventListener("change",async n=>{const e=n.target,t=e.files?e.files[0]:null;if(t)try{const s=u.getAccessToken(),o=await m.upload(t,s);console.log("Upload successful, upload token:",o)}catch(s){console.error("Error uploading image:",s)}}));window.onload=function(){const n=window.google.accounts.oauth2.initTokenClient({client_id:"397214112278-cqkkgppbq08odlaoa7lglrf29evon1jd.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/photoslibrary.appendonly",callback:e=>{console.log("got it",e),u.setAccessToken(e.access_token)}});l==null||l.addEventListener("click",()=>{console.log("clicked"),n.requestAccessToken()})};
